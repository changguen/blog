공간 인덱스는 [[공간 데이터]]들을 잘 쿼리하기 위해 존재한다.
## MySQL에서의 공간 인덱스
- MySQL이 탄생했던 시기에는 평면 지리 정보 시스템 정도를 목표로 했다. (CAD, 도시계획 등)
- 따라서 [[MBR]]을 활용한 [[R-Tree 인덱스]]를 활용하여 공간 인덱스를 구현한다.
	- 사각형인 [[MBR]]을 쓴다는 것은, '정확한' 연산을 원하지 않았다는 것이다.
	- 적당히 쿼리되면 문제없었다.
- 이 시대의 연산들은 다음과 같다.
	- `MBRContains()` : MBR 기준 포함 여부
	- `MBRIntersects()` : MBR 기준 교차 여부
- 하지만 추후에 시대가 바뀌며 정확한 연산들이 필요하게 되었고, 이에 따라 다음과 같은 연산들이 등장했다. (5.6 버전)
	- `ST_Distance()` : 평면 거리 측정
	- `ST_Distance_Sphere()` : 구면 거리 측정
	- `ST_Contains()` : 실제 포함 여부
	- `ST_Intersects()` : 실제 교차 여부
- 위와 같은 연산들은 MySQL의 기본 구조 한계 때문에 **인덱스를 타지 못한다.** -> 보통 MBR 함수들을 먼저 사용하여 필터링 한 후에 적용하게 된다.
## MongoDB 에서의 공간 인덱스
- MongoDB는 MySQL 등장 한참 후에 나왔으며, 구글맵이나 OSM 등이 등장하며 '정확한' 연산이 초기부터 필요했다.
- 따라서 [[MBR]] 대신에 [S2](http://s2geometry.io/) 라는 방식을 활용하며, 인덱스 방식은 [[R-Tree 인덱스]] 대신에 [[B+Tree 인덱스]]를 사용한다.
	- S2는 지구를 동일한 크기의 격자로 나누는 방법이다.
	- 이렇게 나눈 격자들이 서로 인접하면 인덱스 상에서도 가깝게 배치된다.
	- 이 격자들을 비교하며 인덱스를 사용한다.
- MongoDB는 따라서 정확한 연산들만이 존재한다.
	- `$near` : 거리 필터링 & 가까운순정렬
	- `$geoIntersects` : 특정 도형과 겹치는 공간 데이터 반환
	- ...