[공식 링크](https://docs.spring.io/spring-batch/reference/whatsnew.html#batch-infrastrucutre-configuration-improvements)
## 도메인 모델의 불변성 강화
- `Entity`의 ID 타입이 Long -> long으로 변경
- `JobInstance`, `JobExecution` 등의 주요 엔티티에 ID 재할당 불가능
- 작업 매개변수 이름이 `JobParamter`의 일부로 캡슐화
- `JobParamter`가 레코드로 변경, `JobParameters`가 `Set<JobParamter>` 구조로 변경
## 인프라 설정 방식 변경
- 기존에 JDBC에 의존하던 `@EnableBatchProcessing`이 공통 속성 설정용이 되었다.
	- `@EnableJdbcJobRepository` 또는 `@EnableMongoJobRepository` 등으로 저장소를 명시해야 한다.
- **`DefaultBatchConfiguration`은 이제 기본적으로 별도의 DB가 필요없는 인프라를 구성한다.** (`ResourcelessJobRepository` 기반)
```java
@EnableBatchProcessing
@EnableJdbcJobRepository
class MyJobConfiguration {

	@Bean
	public Job job(JobRepository jobRepository) {
		return new JobBuilder("job", jobRepository)
                    // job flow omitted
                    .build();
	}
}
```
## 청크 중심 처리 모델의 새로운 구현
- 기존의 청크 작업은 사실 Tasklet이었다.
  TaskletStep -> ChunkOrientedTasklet
- 이제 순수 청크 기반으로 생성한다. (`ChunkOrientedStep`)
```java
@Bean
public Step chunkOrientedStep(JobRepository jobRepository, ItemReader<Person> itemReader, ItemWriter<Person> itemWriter) {
    int chunkSize = 100;
    return new ChunkOrientedStepBuilder<Person, Person>("step", jobRepository, chunkSize)
            .reader(itemReader)
            .writer(itemWriter)
            .build();
}
```
- 또한 이에 따라 재시도 및 스킵 기능 구현도 바뀌었다.
## 의존성 설정 방식 변경
- 기존 `spring-boot-start-batch` 의존성의 역할이 크게 바뀌었다.
- 기존에는 당연히 JDBC 기반 테이블에 메타데이터를 저장하는 헤비한 형태였지만,
  **6버전부터는 기본이 메타데이터 없이, 세부 의존성을 통해 mongoDB나 jdbc를 통해 메타데이터 저장하도록 설정**하는 식이다.
- **라이브러리 분리**
	- 이제 `spring-boot-start-batch` 의존성은 기본적으로 JobRepository 없는 구성이다. (코어만 존재)
	- jdbc를 사용하려면 `spring-boot-start-batch-jdbc`를 활용해야 한다.
## 기타
- `JobLauncher` 대신에 이를 확장한 `JobOperator`를 사용
- 청크 지향 모델에서 트랜잭션 매니저가 선택사항으로 변경, 이에 따른 API 변화
```java
// v5
Step step = new StepBuilder("myStep", jobRepository)
                .chunk(5, transactionManager)
                // ...
                .build();

// v6
Step step = new StepBuilder("myStep", jobRepository)
                .chunk(5)
                .transactionManager(transactionManager)
                // ...
                .build();
```
- 데이터소스와 마찬가지로 트랜잭션 관리자도 이제 선택 사항, 지정되지 않은 경우 기본 `ResourcelessTransactionManager`가 사용됨
- 우아한 종료 지원 : 이제 우아한 종료가 시작되면 진행중인 단계를 중지하고 재시작이 가능한 상태로 `JobRepository`를 업데이트한다.