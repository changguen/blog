http는 무상태이므로, 사용자별 추적에 어려움이 존재한다.
그렇다고 쿠키에 모든 정보를 저장하면 탈취에 위험이 있다.

따라서 쿠키에는 최소한의 정보를 담고, `세션` 을 도입하여 이를 해결할 수 있다.

### 세션은 어떻게 사용자별 추적을 가능케 하는가?

세션은 각 사용자별 정보를 포함한다. (로그인 여부가 가장 대표적)
세션은 톰캣의 세션저장소 구현체에 저장되며, 세션id를 통해 식별될 수 있다.
사용자의 쿠키에는 세션id가 저장된다. (자바에선 JSESSIONID라는 이름으로)

1. 사용자가 어떠한 요청을 보냈을 때, 쿠키에 세션id를 포함하게 된다.
2. 해당 세션id를 통해 세션저장소에서 세션을 조회한다.
3. 해당 세션을 활용한다.

### 세션을 어떻게 활용해야 하는가?

> 로그인 시나리오
> 
1. 사용자는 로그인 정보를 제출한다.
2. 로그인 정보가 옳다면 세션을 새로 생성한다. (보안을 위해서 기존 세션은 무효화한다.)
3. 새로운 세션에 userId 등의 로그인 정보를 포함시킨다.
4. 사용자도 다음부터 해당 새로운 세션을 참조하도록 새로운 세션id 쿠키를 보내준다.

> 로그인 여부가 필요한 페이지 시나리오
> 
1. 사용자는 요청과 함께 세션id를 보낸다.
2. 해당 세션id를 세션저장소에서 조회하여 세션을 얻는다. (세션이 없다면 로그인 X)
3. 세션에 로그인 정보가 포함되어 있는지 확인한다. (로그인 정보가 없다면 로그인 X)
4. 해당 로그인 정보가 실제로 사용자 목록에 존재하는 것인지 확인한다.

> 사용자 정보가 필요한 페이지 시나리오
> 
1. 사용자는 요청과 함께 세션id를 보낸다.
2. 해당 세션id를 세션저장소에서 조회하여 세션을 얻는다. (세션이 없다면 로그인 X)
3. 세션에 로그인 정보가 포함되어 있는지 확인한다. (로그인 정보가 없다면 로그인 X)
4. 해당 로그인 정보를 통해 실제 사용자를 조회한다.
5. 사용자 정보를 활용한다.